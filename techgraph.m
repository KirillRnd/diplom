X = 1.1*max(R(1,:))+1000000;
Y = 1.1*max(R(2,:))+1000000;
Z = 1.1*max(R(3,:))+1000000;
X1 = 1.1*min(R(1,:))-1000000;
Y1 = 1.1*min(R(2,:))-1000000;
Z1 = 1.1*min(R(3,:))-1000000;



%вывод графика

for i=2:50:iter
    
    plot3(R(1,1:i-1),R(2,1:i-1),R(3,1:i-1),'r:');
    hold on;
    grid on;
    plot3(R(1,i),R(2,i),R(3,i),'b.');%—юда надо главные оси
    
   
    plot3(0,0,0,'b--+');
    hold off;
    axis equal;
    str = ['time ' int2str(h*i) ' s'];
    text(1500000,200,300,str);
    axis([X1 X Y1 Y Z1 Z]);
    
    %pause(0.05)
end
hold on;
matlabfrag('figs/traectory','epspad',[10,10,10,10]);
%plot3([R(1,5000), R(1,5000)+k(1)*1000000],[R(2,5000), R(2,5000)+k(2)*1000000],[R(3,5000), R(3,5000)+k(3)*1000000],'r');
%plot3([R(1,5000), R(1,5000)+K(1)*1000000],[R(2,5000), R(2,5000)+K(2)*1000000],[R(3,5000), R(3,5000)+K(3)*1000000],'r');

%plot3([R(1,2), R(1,2)+Vn(1)*1000000],[R(2,2), R(2,2)+Vn(2)*1000000],[R(3,2), R(3,2)+Vn(3)*1000000],'r');